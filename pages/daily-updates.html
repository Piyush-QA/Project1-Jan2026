<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Daily Updates | Construction Management</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body { min-height: 100vh; overflow-x: hidden; }

    .sidebar {
      width: 260px;
      min-height: 100vh;
      background-color: #1f2937;
    }

    .sidebar a {
      color: #d1d5db;
      text-decoration: none;
      padding: 12px 20px;
      display: block;
    }

    .sidebar a:hover,
    .sidebar a.active {
      background-color: #374151;
      color: #ffffff;
    }

    .content { padding: 20px; width: 100%; }

    /* ‚úÖ Ensure dropdown text visible */
    .dropdown-menu .dropdown-item {
      color: #212529 !important;
    }

    .dropdown-menu .dropdown-item:hover {
      background-color: #f1f5f9;
    }
  </style>
</head>

<body>
<div class="d-flex">

<!-- SIDEBAR -->
<div class="sidebar">
  <h5 class="text-white text-center py-3">üèóÔ∏è CMS</h5>
  <a href="dashboard.html">Dashboard</a>
  <a href="sites.html">Sites</a>
  <a href="workers.html">Workers</a>
  <a href="attendance.html">Attendance</a>
  <a href="overtime.html">Overtime</a>
  <a href="materials.html">Materials</a>
  <a href="dispatch.html">Dispatch</a>
  <a href="daily-updates.html" class="active">Daily Updates</a>
  <a href="payments.html">Payments</a>
  <a href="expenses.html">Expenses</a>
  <a href="pending-work.html">Pending Work</a>
  <hr class="text-secondary">
  <div class="text-center text-white small">
    Manager<br><span class="text-danger">Sign Out</span>
  </div>
</div>

<!-- MAIN CONTENT -->
<div class="content">

<!-- HEADER -->
<div class="d-flex justify-content-between align-items-center mb-3">
  <div>
    <h2 class="mb-0">Daily Updates</h2>
    <p class="text-muted mb-0">Track daily site progress</p>
  </div>
  <div class="d-flex gap-2">
    <button class="btn btn-outline-success" onclick="exportDailyUpdates()">Export to Excel</button>
    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addUpdateModal">
      + Add Update
    </button>
  </div>
</div>

<!-- FILTER BAR -->
<div class="row g-3 mb-4">
  <div class="col-md-3">
    <label class="form-label">From Date</label>
    <input type="date" id="fromDate" class="form-control">
  </div>
  <div class="col-md-3">
    <label class="form-label">To Date</label>
    <input type="date" id="toDate" class="form-control">
  </div>
  <div class="col-md-3">
    <label class="form-label">Site</label>
    <select id="siteFilter" class="form-select">
      <option value="">All Sites</option>
      <option>Site A</option>
      <option>Site B</option>
    </select>
  </div>
</div>

<!-- TABLE -->
<div class="card shadow-sm">
<div class="card-body p-0">
<table class="table mb-0" id="updatesTable">
<thead class="table-light">
<tr>
  <th>Date</th>
  <th>Site</th>
  <th>Work Type</th>
  <th>Description</th>
  <th class="text-end">Progress (%)</th>
  <th class="text-end">Workers</th>
  <th>Drive Link</th>
  <th class="text-center">Actions</th>
</tr>
</thead>

<tbody>
<tr data-date="2026-08-02" data-site="Site A">
  <td>02 Aug 2026</td>
  <td>Site A</td>
  <td>Foundation</td>
  <td>Footing work completed</td>
  <td class="text-end">20</td>
  <td class="text-end">12</td>
  <td>Yes</td>
  <td class="text-center">
    <div class="dropdown">
      <button class="btn btn-sm btn-light" data-bs-toggle="dropdown">‚ãÆ</button>
      <ul class="dropdown-menu dropdown-menu-end">
        <li><a class="dropdown-item" href="#">Edit</a></li>
        <li><a class="dropdown-item text-danger" href="#">Delete</a></li>
      </ul>
    </div>
  </td>
</tr>

<tr data-date="2026-08-04" data-site="Site B">
  <td>04 Aug 2026</td>
  <td>Site B</td>
  <td>Electrical</td>
  <td>Conduit wiring started</td>
  <td class="text-end">10</td>
  <td class="text-end">8</td>
  <td>Yes</td>
  <td class="text-center">
    <div class="dropdown">
      <button class="btn btn-sm btn-light" data-bs-toggle="dropdown">‚ãÆ</button>
      <ul class="dropdown-menu dropdown-menu-end">
        <li><a class="dropdown-item" href="#">Edit</a></li>
        <li><a class="dropdown-item text-danger" href="#">Delete</a></li>
      </ul>
    </div>
  </td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
</div>

<!-- ADD DAILY UPDATE MODAL -->
<div class="modal fade" id="addUpdateModal" tabindex="-1">
<div class="modal-dialog modal-lg">
<div class="modal-content">

<div class="modal-header">
  <h5 class="modal-title">Add Daily Update</h5>
  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
</div>

<div class="modal-body">
<div class="row g-3">

<div class="col-md-6">
  <label class="form-label">Site *</label>
  <select class="form-select">
    <option>Site A</option>
    <option>Site B</option>
  </select>
</div>

<div class="col-md-6">
  <label class="form-label">Date *</label>
  <input type="date" class="form-control">
</div>

<div class="col-md-6">
  <label class="form-label">Work Type</label>
  <select class="form-select">
    <option>Foundation</option>
    <option>Electrical</option>
    <option>Plumbing</option>
    <option>Finishing</option>
  </select>
</div>

<div class="col-md-6">
  <label class="form-label">Progress (%)</label>
  <input type="number" class="form-control" min="0" max="100">
</div>

<div class="col-md-12">
  <label class="form-label">Description *</label>
  <textarea class="form-control"></textarea>
</div>

<div class="col-md-6">
  <label class="form-label">Workers Present</label>
  <input type="number" class="form-control">
</div>

<div class="col-md-6">
  <label class="form-label">Google Drive Link</label>
  <input type="url" class="form-control">
</div>

</div>
</div>

<div class="modal-footer">
  <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
  <button class="btn btn-primary">Post Update</button>
</div>

</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
function exportDailyUpdates() {
  let csv = [];
  csv.push("Date,Site,Work Type,Description,Progress %,Workers,Drive Link");

  const fromDate = document.getElementById("fromDate").value;
  const toDate = document.getElementById("toDate").value;
  const site = document.getElementById("siteFilter").value;

  document.querySelectorAll("#updatesTable tbody tr").forEach(row => {
    const rowDate = row.dataset.date;
    const rowSite = row.dataset.site;

    if (fromDate && rowDate < fromDate) return;
    if (toDate && rowDate > toDate) return;
    if (site && rowSite !== site) return;

    let cols = row.querySelectorAll("td");
    let rowData = [];
    for (let i = 0; i < 7; i++) {
      rowData.push(cols[i].innerText.replace(/,/g, ""));
    }
    csv.push(rowData.join(","));
  });

  const blob = new Blob([csv.join("\n")], { type: "text/csv;charset=utf-8;" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "daily-updates.csv";
  link.click();
}
</script>

</body>
</html>
